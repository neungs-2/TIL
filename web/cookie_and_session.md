# Cookie and Session

<br>

## **쿠키와 세션의 사용 이유**

- HTTP의 특성인 **Connectionless**와 **Stateless**를 극복하기 위해 사용
  - **Connectionless**: 요청에 대한 응답을 받으면 연결을 끊는 특징
  - **Stateless**: 통신이 끝나면 상태를 유지하지 않는 특징

---

<br>

## **쿠키(Cookie)**

- 클라이언트(브라우저) 로컬에 저장되는 키-값 쌍의 작은 데이터 파일
- 클라이언트 상태 정보를 로컬에 저장했다가 참조
  - 클라이언트에 300개 쿠키 저장 가능
  - 한 도메인 당 20개 값만 저장
  - 하나의 쿠키값은 4KB 용량 제한

<br>

**_구성 요소_**

- **이름**: 각 쿠키 식별 값
- **값**: 쿠키 이름과 관련된 값
- **유효시간**: 쿠키 유지시간
- **도메인**: 쿠키를 전송할 도메인
- **경로**: 쿠키를 전송할 요청 경로

<br>

**_동작 방식_**

1. 클라이언트가 페이지 요청
2. 서버에서 쿠키 생성
3. HTTP 헤더에 쿠키를 포함시켜 응답
4. 브라우저 종료되어도 유효시간 지나지 않으면 클라이언트에서 쿠키 보관
5. 같은 요청 시 HTTP 헤더에 쿠키를 함꼐 보냄
6. 서버에서 쿠키를 읽어 이전 상태 정보를 변경할 필요 있을 때 쿠키를 업데이트하여 HTTP 헤더에 포함시켜 응답

<br>

**_예시_**

- 로그인 시 아이디와 비밀번호 저장
- 장바구니
- 팝업 창의 '오늘 더 이상 이 창을 보지 않음' 체크

---

<br>

## **세션(Session)**

- 쿠키를 기반으로 하지만 사용자 정보 파일을 서버 측에서 관리
- 서버에서 세션ID를 부여하여 구분하며 웹 브라우저가 서버에 접속해서 브라우저 종료 시 까지 인증상태 유지 (접속 시간 제한 설정 가능)
- 정보를 서버에서 관리하여 쿠키보다 보안성 우수
- 사용자 많을 경우 서버 메모리 많이 차지
- 동시 접속자 수 많은 경우 서버에 과부하를 주어 성능 저하 요인

<br>

**_동작 방식_**

1. 클라이언트가 서버에 접속 시 세션 ID 발급
2. 클라이언트는 세션 ID에 대해 쿠키를 사용하여 저장하고 서버 요청 시 함께 전달
3. 서버는 세션 ID를 전달 받아서 세션에 있는 클라이언트 정보 가져와서 사용
4. 클라이언트 정보를 가지고 서버 요청을 처리하여 클라이언트에게 응답

<br>

**_세션의 특징_**

- 각 클라이언트에게 고유 ID 부여
- 세션 ID로 클라이언트 구분하여 요구에 맞는 서비스 제공
- 쿠키보다 보안 우수
- 사용자 많을 수록 서버 메모리 만힝 차지

<br>

**_예시_**

- 로그인 처럼 보안상 중요한 작업

---

<br>

## **쿠키와 세션 차이**

**_저장 위치_**

- 쿠키: 클라이언트 (서버 자원 사용X)
- 세션: 서버 (서버의 자원 사용)

**_보안성_**

- 쿠키 < 세션
- 쿠키는 스니핑에 취약하여 보안면에서 세션이 더 우수

**_요청 속도_**

- 쿠키 > 세션
- 세션은 서버의 처리가 필요하여 쿠키가 더 빠름

**_라이프 사이클_**

- 쿠키: 만료 시간이 있지만 파일로 저장되어 브라우저를 종료해도 정보 존재
- 세션: 브라우저 종료 시 만료 시간 상관 없이 삭제 (크롬에서 다른 탭 사용시 세션 공유)

---

<br>

## **ETC**

- 세션의 보안성이 우수한데 쿠키를 사용하는 이유
  - 세션을 무분별하게 사용 시 서버 메모리 용량 많이 차지하고 속도가 느려짐

<br>

- 쿠키와 캐시의 차이점
  - 캐시는 이미지, CSS, JS 파일 등을 브라우저나 서버 앞 단에 저장하고 사용하는 것

<br>

- 쿠키와 세션의 대안
  - 최근에는 문제점을 보완한 토큰 기반의 인증방식을 사용하는 추세
  - ex) JWT
